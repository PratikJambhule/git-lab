This is final merged code by Pratik

